---
Title: Логические операторы
Sort: 5
---

Сложные задачи требуют сложных условий для среза. Представьте, что вам нужно отобразить покупателей из Москвы или Перми, которые покупают продукцию только определённой компании. Отбирать данные по городам вы умеете, но как объединить два города в запросе? И добавить условие с названием компании? 
Для таких задач используют логические операторы. С их помощью можно объединять условия или выбирать всё, что этим условиям не соответствует. В SQL таких операторов три: `AND`, `OR`, `NOT`.

### Операторы `AND` и `OR`

Операторы `AND` и `OR` позволяют объединять условия. `AND` применяют в том случае, если выгружаемые данные должны соответствовать всем перечисленным условиям.

Объединим два условия и отберём всех жителей Тулы старше 43 лет: 

```SQL
WHERE city = 'Тула'
  AND age > 43;
```

Туляки младше этого возраста в список не войдут. А жители других городов и подавно. 

Отобрать данные, которые удовлетворяют одному из условий, можно оператором `OR`:

```SQL
WHERE city = 'Тула'
  OR city = 'Пермь'; 
```

В таком списке окажутся не только жители Тулы, но и жители Перми. 

### Оператор `NOT`

Чтобы отобрать жителей всех городов, кроме Тулы, можно «перевернуть» условие оператором `NOT`. С его помощью выгружают записи, которые не соответствуют условию:

```SQL
WHERE NOT city = 'Тула'; 
```

Оператор `NOT` можно также использовать в нескольких условиях. Следом за туляками из выборки пропадут и пермяки:

```SQL
WHERE NOT city = 'Тула'
  AND NOT city = 'Пермь'; 
```

### Правила действия логических операторов

С такими простыми примерами сложностей не возникает, но иногда непросто разобраться, какие значения вернёт тот или иной оператор. 
На самом деле поведение операторов можно описать правилами. Условия, которые вы объединяете в запросе после `WHERE`, представляют собой утверждения. В запросе ниже их два:

```SQL
WHERE city = 'Тула'
  OR city = 'Пермь'; 
```

В переводе с языка SQL на человеческий эти утверждения выглядят так:
- Человек проживает в городе Тула.
- Человек проживает в городе Пермь.

Каждое из них проверяется на истинность, и на выходе получается либо значение `TRUE`, если утверждение истинно, или `FALSE`, если ложно. Затем каждый из логических операторов действует по своим правилам:
- `AND` возвращает `TRUE`, только если оба логических значения тоже `TRUE`.
- `OR` возвращает `TRUE`, если хотя бы одно логическое значение тоже `TRUE`.
- `NOT` меняет значение выражения на противоположное: `TRUE` на `FALSE`, а `FALSE` на `TRUE`.

Возможные сочетания можно собрать в таблицу истинности:

Выражение А|	Выражение B|	WHERE A AND B|	WHERE A OR B|	WHERE NOT A
--|--|--|--|--
TRUE|	TRUE|	TRUE|	TRUE|	FALSE|
TRUE|	FALSE|	FALSE|	TRUE|	FALSE|
FALSE|	TRUE|	FALSE|	TRUE|	TRUE|
FALSE|	FALSE|	FALSE|	FALSE|	TRUE|

Благодаря логическим операторам в SQL можно записать сложные, но непротиворечивые условия. Ради этого приходится заучивать правила, по которым действуют логические операторы.

### Приоритет операторов

Кажется, разобраться с такими условиями уже не так легко. Чем больше условий, тем сложнее уследить за логикой операторов. Условия с разными логическими операторами различаются приоритетом. Первым всегда выполняется условие с оператором `NOT`, за ним `AND` и только в последнюю очередь — условие с `OR`. 

Управлять порядком можно с помощью скобок. В математике арифметические операции в скобках имеют больший приоритет и выполняются первыми. В SQL так же: скобки помогут комбинировать условия и получить нужный срез.

Продолжим отбирать жителей разных городов:

```SQL
WHERE age > 43
  AND city = 'Тула'
  OR city = 'Пермь'
  AND age < 43; 
```

Кого охватит такое условие — туляков старше 43 лет или пермяков моложе 43 лет? И тех и других. Это условие можно переписать так:

```SQL
WHERE (age > 43
  AND city = 'Тула')
  OR (city = 'Пермь'
  AND age < 43); 
```

Результат будет одинаковым. Условия с оператором `AND` обладают большим приоритетом, чем условия с `OR`. Вспомните математику: умножение выполняется перед сложением. У логических операторов похожая логика. Если добавить скобки, можно не сомневаться в том, что в срез попадут нужные данные.

Сравните с другим условием:

```SQL
WHERE age > 43
  AND (city = 'Тула'
  OR city = 'Пермь'); 
```

Условие в скобках приоритетнее, значит, в таблицу попадут и туляки, и пермяки, чей возраст больше 43 лет.

Лучше разобраться в работе логических операторов можно в [бесплатном тренажёре «Основы математики для цифровых профессий»](https://practicum.yandex.ru/math-foundations/). См. модуль «Множества и логика», тема «Элементы логики», уроки «Высказывания и основные логические операторы», «Эквиваленция и формулы», «Упрощение сложных формул».

