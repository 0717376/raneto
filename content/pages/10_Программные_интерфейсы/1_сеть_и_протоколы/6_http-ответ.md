---
Title: HTTP-ответ
Sort: 6
---

Как вы помните из прошлого урока, взаимодействие через HTTP построено на концепции запрос-ответ. Сервер отправляет клиенту ответ, сообщая, смог ли он выполнить запрос клиента.

<img src="%base_url%/images/CA-09-Sprint-001-15_1675186805.png"/>
<br><br>

HTTP-ответ должен включать в себя:
- Код состояния (Status Code).
- Заголовки (Headers).
- Тело (Body).

<img src="%base_url%/images/S9-edit-01_1_1675186894.png"/>
<br><br>

HTTP-ответ может выглядеть так:

<img src="%base_url%/images/S9-edit-02_1675186936.png"/>
<br><br>

### Код состояния

**Код состояния** — это трёхзначное число, которое кратко информирует о результате выполнения запроса. 

Код состояния может передать клиенту много ценной информации. Например, вы могли видеть страницу с таким ответом на каком-либо веб-сайте:

<img src="%base_url%/images/CA-09-Sprint-001-17_1675186856.png"/>
<br><br>

Код состояния 404 означает, что ресурс не найден (Not Found). Когда клиент запрашивает ресурс, которого не существует, сервер отвечает кодом 404, чтобы дать клиенту понять, что такого ресурса на сервере нет и клиенту нет смысла его запрашивать. После получения ответа от сервера цикл «запрос-ответ» завершается, и сеанс связи закрывается. Сервер больше не будет отправлять клиенту никаких данных до тех пор, пока не получит новый запрос.

Коды, которые пользователи видят в веб-браузере при ошибке, можно объединить в группы по значению, исходя из результата выполнения запроса. Коды всегда состоят из трёх цифр, и по первой можно определить, к какой группе относится ответ:
- 1хх — предварительный ответ на запрос;
- 2хх — запрос успешно обработан;
- 3хх — сообщает, что для успешного выполнения операции необходимо сделать другой запрос;
- 4хх — ошибки на клиенте (то есть у того, кто выполняет запрос);
- 5хх — ошибки на сервере (то есть у того, кто выдаёт ответ).

В описании метода указывают, какие коды состояния веб-сервер может вернуть в ответ на запрос. Главная цель клиента при отправке любого запроса — получить от сервера трёхзначный код, который начинается с двойки, то есть код успешной обработки запроса. Если сервер возвращает ответ с кодом, начинающимся с тройки, четвёрки или пятёрки, необходимо либо изменить запрос, либо дождаться, когда ошибка на сервере будет устранена.

#### 1хх

Этот код состояния обозначают предварительный ответ. Клиентский компьютер получит один или несколько ответов 1xx прежде, чем получить обычный ответ.

<img src="%base_url%/images/1xx_1675263244.png"/>
<br><br>

#### 2хх

Эти коды состояния указывают на успешное принятие сервером запроса.

<img src="%base_url%/images/2xx_1_1675433647.png"/>
<br><br>

#### 3хх

Эти коды состояний указывают на то, что клиенту необходимо совершить дополнительные действия для выполнения запроса.

<img src="%base_url%/images/3xx_1675263371.png"/>
<br><br>

#### 4хх

Эти коды состояния указывают на возникновение ошибки на стороне клиента. Например, клиент мог запросить несуществующую страницу.

<img src="%base_url%/images/4xx_1675263423.png"/>
<br><br>

#### 5хх

Эти коды состояния указывают на то, что сервер не может выполнить запрос, так как столкнулся с ошибкой.

<img src="%base_url%/images/5xx_1675263628.png"/>
<br><br>

В качестве примера рассмотрим ответ на запрос к ресурсу предметы-сервировки-стола.рф.

```jsx
GET http://предметы-сервировки-стола.рф
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5 (.NET CLR 3.5.30729)
Accept: text/html
Accept-Language: ru  

-> 401 
```

В ответ приходит код 401, который означает, что пользователь неавторизован, а неавторизованным пользователям выполнять запрос к этому ресурсу запрещено.

Чтобы избавиться от этой ошибки, передадим данные авторизации в заголовке запроса.

```jsx
GET http://предметы-сервировки-стола.рф
Authorization: Basic FjgFIKVcGVuc5HgjTk
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.5) Gecko/20091102 Firefox/3.5.5 (.NET CLR 3.5.30729)
Accept: text/html
Accept-Language: en  

-> 200 
```

Теперь в ответе код 200. Запрос выполнен успешно!

### Заголовки

Назначение заголовка ответа схоже с назначением заголовка запроса. Если в запросе веб-браузер через заголовок сообщает серверу, как читать запрос, то в ответе сервер сообщает браузеру, как интерпретировать полученный ответ. Поля заголовка HTTP-ответа помогают клиенту (веб-браузеру) правильно обработать HTTP-сообщение веб-сервера.

### Параметры заголовка ответа (Response Header Parameters)

В заголовках ответа используются те же параметры типовых заголовков, что и в запросах, например: `Content-Type`, `Content-Length`, `Content-Location`. В дополнение к типовым заголовкам в ответах используются специализированные заголовки, которые применяются только в ответах на запрос клиента. Вот некоторые из них:

Параметр заголовка|	Назначение
--|--
Status|	Сообщает код ответа HTTP<br>`Status: 200`
`Retry-After`|	Заголовок HTTP ответа показывает, как долго клиент должен подождать перед следующим запросом. Обычно возвращается вместе с кодом ошибки 5xx. Может быть указано конкретное время или задержка в секундах.<br>`Retry-After: Tue, 30 Oct 2022 09:30:00 GMT` <br>`Retry-After: 180`
`Location`|	URL имеющегося (с кодом 3xx) или вновь созданного (с кодом 201) ресурса, по которому клиент может перейти.<br>`Location: http://предметы-сервировки-стола.рф`
`Allow`|	Список поддерживаемых методов<br>`Allow: POST, GET, TRACE, HEAD`
`Server`|	Список названий и версий веб-сервера и его компонентов.<br>`Server: Apache/2.4.54`
`Age`|	Возвращает количество секунд, прошедших с момента модификации ресурса.<br>`Age: 154034`
`Date`|	Возвращает время формирования ответа и позволяет клиенту обновить время у себя.<br>`Date: Sat, 30 Nov 2022 18:15:00 GMT`
`Last-Modified`|	Возвращает время последнего редактирования ресурса и позволяет клиенту проверить актуальность данных в кэше.<br>`Last-Modified: Fri, 30 Dec 2020 14:38:54 GMT`
`WWW-Authenticate`|	Параметры аутентификации для осуществления доступа к указанному ресурсу возвращаются обычно с кодом 401.<br>Например, `WWW-Authenticate: Basic` означает, что данные пользователя будут переданы закодированными в base64

Так может выглядеть пример заголовка в ответе на запрос к ресурсу предметы-сервировки-стола.рф.

```
Status: 200 
Content-Type: text/html 
Date: Mon, 24 Jul 2022 16:06:00 GMT
Last-Modified: Mon, 18 Jul 2016 02:36:04 GMT
Server: Apache/1.3.27 
```

В результате запроса был получен код ответа 200 (Status Code), ответ передан в формате html и сформирован 24 июля, 2022 года, а последний раз ресурс обновлялся 18 июля 2016  года, ответ пришёл с сервера Apache версии 1.3.27.

### Тело

Если код состояния всего лишь показывает результат обработки запроса (успех или неуспех), то тело ответа содержит данные, которые необходимы клиенту, отправившему запрос. 

Как и в случае с запросами, наличие в ответе тела зависит от используемого в запросе метода. Например, у запроса с методом DELETE тело ответа может отсутствовать, так как достаточно кода ответа (ресурс либо удалён, либо нет). Тело ответа будет содержать запросы с методами GET и POST, потому что эти запросы подразумевают получение данных.

В случае с методом GET http://предметы-сервировки-стола.рф/кофейная-пара/чашка мы ожидаем получить все данные, связанные с ресурсом «чашка»: идентификатор, материал, диаметр. Какую информацию мы действительно получим, расскажет именно тело ответа. 

Например, для кода ответа 200 тело ответа может быть таким:

```json

{
    “responseBody”: [
        {
            ”id”: 1,
            “material”: “фарфор”,
            “diameter”: 10},
        {
            ”id”: 2,
            “material”: “стекло”,
            “diameter”: 12}
        ]
}
```


В теле этого ответа указан список ресурсов «чашка», которые были найдены по запросу. Серверу удалось найти два таких ресурса с разными идентификаторами (id) и характеристиками (material, diameter).

Данное тело ответа описано с использованием стиля представления данных JSON. Ответ может также содержать текст, изображение и другой тип данных. Если бы по запросу не было найдено ресурсов, сервер вернул бы ответ с кодом 400. Тело ответа выглядело бы так:

```json
 {
    “responseBody”: 
        {
            ”Error”: "По запросу ничего не найдено, проверьте корректность запроса"
    }
} 
```

### Подведём итоги

В ответ на HTTP-запрос сервер отправляет клиенту HTTP-ответ. 

HTTP-ответ состоит из:
- Кода состояния (Status Code).

Код состояния показывает результат обработки запроса. Коды всегда состоят из трёх цифр, по первой можно определить статус ответа (успех или неуспех) и причины ошибки.
- Заголовков (Headers).

В заголовках сервер сообщает браузеру, как интерпретировать полученный ответ.
- Тела (Body).

Тело ответа содержит данные, которые необходимы клиенту, отправившему запрос. 

Заголовки и тело ответа могут быть написаны с помощью разных стилей представления данных. О них поговорим в следующем уроке.